---
title: "project2"
author: "Miao"
date: "2021/7/11"
output:
  pdf_document:
    latex_engine: pdflatex
    number_sections: yes
  html_document:
    df_print: paged
  word_document: default
fig_caption: yes
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = TRUE, warning = FALSE, message = FALSE, comment = NA)
```

```{r libraries,echo = FALSE}
library(tidyverse)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(devtools)
library(magrittr)
library(ggplot2)
library(maps)
library(RColorBrewer)
library(viridis)
library(ggpubr)
library(GGally)
library(corrplot)
library(knitr)
library(olsrr)
library(data.table)
library(moderndive)
library(ggfortify)
library(diagram)
library(ggthemes)
library(cowplot)
library(showtext)
```

```{R data, echo = TRUE, eval = TRUE, warning = TRUE, message = TRUE}
#read the file
dat<-read.csv("./dataset9.csv")
#add the score column,if rating>7,then 1,else 0
dat<-mutate(dat,score=ifelse(rating>7,1,0))
#replace NA with mean value in length column 
dat$length[is.na(dat$length)]<-mean(dat$length,na.rm = TRUE)
dat$scorename[dat$score==1] <- "greater than 7"
dat$scorename[dat$score==0] <- "lower than 7"
```

# Introduction {#sec:Intro}

This is introduction.

# Main Definitions And Method {#sec:MET}

# objective

objective objective

# variables

this is `variable` part!



```{r pie, echo = FALSE, eval = TRUE,fig.align = "center", fig.cap = "\\label{fig: piegenre} genre pie chat",out.heighth='75%',out.width='75%',fig.pos = 'H'}
# Barplot
mytable <- xtabs(~genre+scorename,data=dat)
table <- prop.table(mytable)
table <- data.frame(table)
#$labelPosition<-table$Freq
#table$label<-paste0(table$category,"\n value: ",table$Freq*100,"%")

ggplot(table, aes(x=scorename, fill=genre))+
  geom_bar()+
  coord_polar("y")+
  labs(x = '', y = '', title = '')+
  theme(axis.text = element_blank()) + 
  theme(axis.ticks = element_blank())
  #geom_label(x=3.5,aes(y=labelPosition,label=label),size=4)+
```

```{r boxplot1, echo = FALSE, eval = TRUE,fig.align = "center", fig.cap = "\\label{fig:boxplotyear} Year boxplot",out.heighth='75%',out.width='75%',fig.pos = 'H'}
#boxplot of year
boxplot1 <- ggplot(dat)+geom_boxplot(aes(x=scorename, y=year, fill= genre))+
  guides(fill = FALSE) +
  theme_wsj() +
  scale_fill_gdocs()+
  guides(fill=guide_legend())+ 
  theme(plot.title = element_text(size = 10,hjust = 0.5, face = "bold"),
        text = element_text(size = 10,face = "bold",hjust = 0.5),
        axis.title.y = element_text(face = "bold",hjust = 0.5),
        axis.text.x = element_text(size =10,face ="bold"))+
 labs(x="Score", y="Year")
boxplot1
```

